<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Poll Results</title>
  <script src="https://cdn.socket.io/4.0.1/socket.io.min.js"></script> <!-- Import Socket.IO -->
</head>
<body>
  <h1>Poll Results</h1>
  <ul id="poll-results"></ul> <!-- List to display poll results -->

  <script>
    // Connect to the Socket.IO server
    const socket = io('http://localhost:5001');

    // Reference to the poll results list element
    const pollResultsList = document.getElementById('poll-results');

    // Function to update the poll results on the page
    function updatePollResults(update) {
      console.log('Received poll update:', update);

      // Create a new list item for each update
      const listItem = document.createElement('li');
      listItem.textContent = `Poll ID: ${update.pollId}, Option ID: ${update.optionId}, User ID: ${update.userId}`;
      
      // Append the new list item to the poll results list
      pollResultsList.appendChild(listItem);
    }

    // Listen for poll updates from the server
    socket.on('pollUpdate', updatePollResults);

    // Clean up the socket connection when the user leaves the page
    window.addEventListener('beforeunload', () => {
      socket.off('pollUpdate');
      socket.disconnect();
    });
  </script>
</body>
</html>